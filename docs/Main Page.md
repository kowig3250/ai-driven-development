## 메인페이지 기능명세서

---

### 프론트엔드 기능명세서

#### 1. 화면 레이아웃 및 디자인 명세

- **파일 위치**: `app/page.tsx`

1. **제목 섹션**
   - **UI 구성**: 화면 상단 중앙에 배치된 제목과 부제목
   - **내용**: "AI로 상상을 현실로 만드세요." 제목과 "프롬프트를 입력하고 AI가 당신의 상상을 이미지로 만들어드립니다." 부제목
   - **인증 상태**: 인증된 사용자의 이름 표시

2. **프롬프트 입력 섹션**
   - **UI 구성**: 화면 상단 중앙에 배치된 텍스트 입력 필드로, 전체 너비의 2/3 크기로 설정
   - **상호작용**: 
     - 인증된 사용자만 프롬프트 입력 가능
     - 비인증 사용자는 로그인 유도 메시지 표시
   - **오류 처리**: 
     - 프롬프트 필드가 비어 있을 경우 이미지 생성 버튼이 비활성화됨
     - 비인증 상태일 경우 로그인 버튼 표시
   - **추가 사항**: 
     - 입력 필드에 포커스 시 파란색 테두리 효과 적용
     - 인증 상태에 따른 UI 변경

3. **이미지 생성 버튼**
   - **UI 구성**: 프롬프트 입력 필드 하단에 배치되며, 전체 너비의 2/3 크기로 설정
   - **상호작용**: 
     - 인증된 사용자: 프롬프트 입력 후 버튼 활성화
     - 비인증 사용자: 로그인 버튼으로 대체
   - **상태 표시**: 
     - 비활성화 상태: 회색 배경
     - 활성화 상태: 파란색 배경, 호버 시 진한 파란색
     - 비인증 상태: 로그인 버튼 표시

4. **커뮤니티 피드 섹션**
   - **UI 구성**: 메인 화면 하단에 카드형 그리드 레이아웃으로 표시
   - **반응형 레이아웃**: 
     - 모바일: 1열
     - 태블릿: 2열
     - 데스크톱: 3열
   - **카드 구성**:
     - 이미지: 정사각형 비율로 표시
     - 사용자 정보: 프로필 이미지와 사용자명
     - 프롬프트: 2줄까지 표시
     - 상호작용 정보: 좋아요 수, 댓글 수
   - **상호작용**: 
     - 카드 클릭 시 게시물 상세 페이지(`/post/[postId]`)로 이동
     - 인증된 사용자만 좋아요/댓글 가능

5. **오류 페이지**
   - **파일 위치**: `app/error/page.tsx`
   - **UI 구성**:
     - 오류 메시지 표시
     - 홈으로 돌아가기 버튼
   - **상호작용**: 버튼 클릭 시 메인 페이지로 이동

#### 2. 사용자 흐름 및 상호작용

1. **인증 상태 확인 → 프롬프트 입력 → 이미지 생성**
   - 사용자 인증 상태 확인
   - 인증된 경우 프롬프트 입력 가능
   - 비인증인 경우 로그인 유도
   - 이미지 생성 버튼 클릭 시 오류 페이지로 이동

2. **커뮤니티 피드 상호작용**
   - 카드 클릭 시 상세 페이지 이동
   - 인증된 사용자만 좋아요/댓글 가능
   - 비인증 사용자는 로그인 유도

#### 3. API 연동

1. **커뮤니티 피드 데이터**
   - **데이터 구조**: `mockPosts` 배열을 통해 목업 데이터 제공
   - **데이터 필드**:
     ```typescript
     {
       postId: string;
       imageURL: string;
       userName: string;
       userProfile: string;
       createdAt: string;
       prompt: string;
       styleOptions: {
         style: string;
         quality: string;
         aspectRatio: string;
       };
       likes: number;
       comments: number;
       scraps: number;
       isLiked: boolean;
       isScrapped: boolean;
       userId: string; // Clerk 사용자 ID
     }
     ```

2. **인증 상태 관리**
   - **Clerk 컴포넌트**:
     ```typescript
     <SignedIn>
       {/* 인증된 사용자를 위한 UI */}
     </SignedIn>
     <SignedOut>
       {/* 비인증 사용자를 위한 UI */}
     </SignedOut>
     ```
   - **사용자 정보**:
     ```typescript
     const { isLoaded, isSignedIn, user } = useUser();
     ```

#### 4. 테스트 항목

1. **인증 상태**
   - 비인증 사용자의 접근 제한 확인
   - 로그인 후 기능 접근 확인
   - 로그아웃 시 상태 변경 확인

2. **프롬프트 입력 필드**
   - 텍스트 입력 필드에 프롬프트가 정상적으로 입력되는지 확인
   - 빈 입력 상태에서 이미지 생성 버튼이 비활성화되는지 확인
   - 비인증 상태에서 로그인 유도 메시지가 표시되는지 확인

3. **이미지 생성 버튼**
   - 인증된 사용자의 경우 프롬프트 입력 후 버튼이 활성화되는지 확인
   - 비인증 사용자의 경우 로그인 버튼이 표시되는지 확인
   - 클릭 시 오류 페이지로 이동하는지 확인

4. **커뮤니티 피드**
   - 커뮤니티 피드가 정상적으로 로드되는지 확인
   - 반응형 레이아웃이 올바르게 적용되는지 확인
   - 카드 클릭 시 상세 페이지로 이동하는지 확인
   - 인증 상태에 따른 상호작용 제한이 올바른지 확인

5. **오류 페이지**
   - 이미지 생성 버튼 클릭 시 오류 페이지로 이동하는지 확인
   - 홈으로 돌아가기 버튼이 정상 작동하는지 확인

---

### 백엔드 기능명세서

#### 1. 커뮤니티 피드 데이터

- **파일 위치**: `lib/mock-data.ts`
- **데이터 구조**: 목업 데이터를 통한 정적 데이터 제공
- **데이터 필드**: 프론트엔드 기능명세서의 API 연동 섹션 참조

#### 2. 인증 처리

- **파일 위치**: `middleware.ts`
- **기능**:
  - Clerk의 `clerkMiddleware` 사용
  - `createRouteMatcher`를 통한 라우트 매칭
  - 공개 라우트 설정:
    ```typescript
    const publicRoutes = ["/", "/sign-in(.*)", "/sign-up(.*)"];
    const ignoredRoutes = ["/api/webhook"];
    ```
  - 비동기 인증 처리:
    ```typescript
    export default clerkMiddleware(async (auth, request) => {
      if (isPublic(request) || isIgnored(request)) {
        return;
      }
      await auth.protect();
    });
    ```

#### 3. 테스트 항목

1. **목업 데이터**
   - 목업 데이터가 올바른 형식으로 정의되어 있는지 확인
   - 모든 필수 필드가 포함되어 있는지 확인
   - 데이터 타입이 올바른지 확인

2. **인증 처리**
   - `clerkMiddleware`가 정상 작동하는지 확인
   - `createRouteMatcher`를 통한 라우트 매칭이 정확한지 확인
   - 공개 라우트 접근이 가능한지 확인
   - 보호된 라우트 접근이 제한되는지 확인
   - 비동기 인증 처리가 정상 작동하는지 확인